# üöÄ Deployment Guide - Guess Who's Lying

## üìã Pre-Deployment Checklist

### ‚úÖ **Code & Build**
- [x] All features implemented and tested
- [x] SEO optimization completed
- [x] Favicon and social media assets created
- [x] No linting errors
- [ ] Build test successful
- [ ] Performance optimization verified

### ‚úÖ **Configuration**
- [x] Environment variables documented
- [x] Database schema ready
- [x] Socket.IO configuration
- [x] CORS settings configured
- [ ] Production environment variables set

### ‚úÖ **Assets & Media**
- [x] Favicon suite (all sizes)
- [x] Open Graph image
- [x] Social media assets
- [x] Sitemap and robots.txt
- [ ] CDN configuration (if applicable)

## üåê **Deployment Options**

### **Option 1: Vercel (Recommended)**
- ‚úÖ **Pros**: Easy Next.js deployment, automatic SSL, global CDN
- ‚úÖ **Best for**: Quick deployment, automatic scaling
- üîó **Setup**: Connect GitHub repo to Vercel

### **Option 2: Netlify**
- ‚úÖ **Pros**: Easy setup, good for static sites
- ‚ö†Ô∏è **Note**: May need serverless functions for Socket.IO

### **Option 3: Railway/Render**
- ‚úÖ **Pros**: Full-stack deployment, database included
- ‚úÖ **Best for**: Backend + frontend together

### **Option 4: VPS/Cloud Server**
- ‚úÖ **Pros**: Full control, custom configuration
- ‚ö†Ô∏è **Note**: Requires more setup and maintenance

## üîß **Environment Variables**

### **Required Variables**
```bash
# Database
DATABASE_URL="postgresql://username:password@host:port/database"

# Socket.IO
NEXT_PUBLIC_SOCKET_URL="wss://yourdomain.com"
SOCKET_CORS_ORIGIN="https://yourdomain.com"

# Optional: Analytics
NEXT_PUBLIC_GA_ID="G-XXXXXXXXXX"
NEXT_PUBLIC_SITE_URL="https://yourdomain.com"
```

### **Development vs Production**
```bash
# Development (.env.local)
NODE_ENV=development
DATABASE_URL="postgresql://localhost:5432/fibs_dev"

# Production (.env.production)
NODE_ENV=production
DATABASE_URL="postgresql://prod-host:5432/fibs_prod"
```

## üóÑÔ∏è **Database Setup**

### **Production Database**
1. **Create PostgreSQL database**
2. **Run migrations**:
   ```bash
   npx prisma db push
   npx prisma db seed
   ```
3. **Verify schema**:
   ```bash
   npx prisma studio
   ```

### **Database URLs by Provider**
```bash
# Railway
DATABASE_URL="postgresql://postgres:password@containers-us-west-xyz.railway.app:5432/railway"

# Supabase
DATABASE_URL="postgresql://postgres:password@db.xyz.supabase.co:5432/postgres"

# PlanetScale
DATABASE_URL="mysql://username:password@host/database?sslaccept=strict"

# Neon
DATABASE_URL="postgresql://username:password@host.neon.tech/database"
```

## üèóÔ∏è **Build Process**

### **Local Build Test**
```bash
# Install dependencies
npm install

# Build the project
npm run build

# Test the build
npm start

# Check for errors
npm run lint
```

### **Build Optimization**
```bash
# Analyze bundle size
npm run build -- --analyze

# Check for unused dependencies
npx depcheck

# Optimize images
npx next-optimized-images
```

## üîí **Security Configuration**

### **Security Headers**
```javascript
// next.config.js
const securityHeaders = [
  {
    key: 'X-DNS-Prefetch-Control',
    value: 'on'
  },
  {
    key: 'X-XSS-Protection',
    value: '1; mode=block'
  },
  {
    key: 'X-Frame-Options',
    value: 'SAMEORIGIN'
  },
  {
    key: 'X-Content-Type-Options',
    value: 'nosniff'
  },
  {
    key: 'Referrer-Policy',
    value: 'origin-when-cross-origin'
  }
];
```

### **CORS Configuration**
```javascript
// Socket.IO CORS
const io = new Server(server, {
  cors: {
    origin: process.env.SOCKET_CORS_ORIGIN || "http://localhost:3000",
    methods: ["GET", "POST"],
    credentials: true
  }
});
```

## üìä **Monitoring & Analytics**

### **Google Analytics Setup**
1. Create GA4 property
2. Add tracking ID to environment variables
3. Verify tracking works

### **Error Monitoring**
```javascript
// Sentry (optional)
import * as Sentry from "@sentry/nextjs";

Sentry.init({
  dsn: process.env.NEXT_PUBLIC_SENTRY_DSN,
  environment: process.env.NODE_ENV,
});
```

### **Performance Monitoring**
- Google PageSpeed Insights
- Lighthouse CI
- Core Web Vitals tracking

## üåç **Domain & DNS**

### **Domain Configuration**
1. **Purchase domain** (if not done)
2. **Configure DNS**:
   ```
   Type: A Record
   Name: @
   Value: [Your server IP]
   
   Type: CNAME
   Name: www
   Value: yourdomain.com
   ```
3. **SSL Certificate**: Auto-generated by hosting provider

### **Update SEO URLs**
Replace all instances of `https://guess-whos-lying.com` with your actual domain:
- `src/app/layout.tsx`
- `public/sitemap.xml`
- `public/robots.txt`
- `src/app/game/metadata.ts`

## üöÄ **Deployment Steps**

### **Vercel Deployment**
1. **Connect Repository**:
   ```bash
   # Install Vercel CLI
   npm i -g vercel
   
   # Login and deploy
   vercel login
   vercel --prod
   ```

2. **Configure Environment Variables**:
   - Add all required env vars in Vercel dashboard
   - Set `NODE_ENV=production`

3. **Custom Domain**:
   - Add domain in Vercel dashboard
   - Update DNS records

### **Manual Server Deployment**
1. **Server Setup**:
   ```bash
   # Install Node.js, PM2, Nginx
   sudo apt update
   sudo apt install nodejs npm nginx
   npm install -g pm2
   ```

2. **Deploy Code**:
   ```bash
   git clone your-repo
   cd fibs
   npm install
   npm run build
   ```

3. **Start Application**:
   ```bash
   pm2 start npm --name "fibs" -- start
   pm2 startup
   pm2 save
   ```

## ‚úÖ **Post-Deployment Verification**

### **Functionality Tests**
- [ ] Home page loads correctly
- [ ] Game creation works
- [ ] Game joining works
- [ ] Real-time features work
- [ ] Mobile responsiveness
- [ ] SEO meta tags appear
- [ ] Favicon displays
- [ ] Social sharing works

### **Performance Tests**
- [ ] Page load speed < 3 seconds
- [ ] Lighthouse score > 90
- [ ] Core Web Vitals pass
- [ ] Mobile-friendly test passes

### **SEO Verification**
- [ ] Google Search Console setup
- [ ] Sitemap submitted
- [ ] Meta tags verified
- [ ] Open Graph previews work
- [ ] Structured data validates

## üîÑ **Continuous Deployment**

### **GitHub Actions (Optional)**
```yaml
# .github/workflows/deploy.yml
name: Deploy
on:
  push:
    branches: [main]
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-node@v2
        with:
          node-version: '18'
      - run: npm ci
      - run: npm run build
      - run: npm run deploy
```

## üìû **Support & Maintenance**

### **Monitoring Checklist**
- [ ] Uptime monitoring setup
- [ ] Error tracking configured
- [ ] Performance monitoring active
- [ ] Database backup strategy
- [ ] Log rotation configured

### **Regular Maintenance**
- [ ] Update dependencies monthly
- [ ] Monitor performance metrics
- [ ] Review error logs weekly
- [ ] Backup database regularly
- [ ] Update SSL certificates

## üéØ **Success Metrics**

### **Technical KPIs**
- Page load time < 3 seconds
- Uptime > 99.5%
- Error rate < 1%
- Lighthouse score > 90

### **Business KPIs**
- User engagement
- Game sessions per day
- Player retention
- Social shares

---

## üö® **Emergency Procedures**

### **If Site Goes Down**
1. Check server status
2. Review error logs
3. Restart services if needed
4. Rollback if necessary

### **Database Issues**
1. Check database connection
2. Verify migrations
3. Restore from backup if needed
4. Contact hosting provider

---

**Ready to deploy? Choose your hosting provider and follow the specific steps above!** üöÄ
